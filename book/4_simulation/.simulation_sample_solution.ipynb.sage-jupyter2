{"backend_state":"init","kernel":"python3","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.7"}},"trust":false,"type":"settings"}
{"cell_type":"code","exec_count":1,"id":"2e2a1b","input":"import numpy as np\nimport matplotlib.pyplot as plt\n\nr_X = 1\nn_hours = 8\ninitial_population = 1000\npop_X = np.zeros(n_hours + 1)\n\npop_X[0] = initial_population\nfor i in range(n_hours):\n    pop_X[i + 1] = pop_X[i] + pop_X[i] * r_X\n    \nprint(\"Population of species X:\", pop_X)","output":{"0":{"name":"stdout","output_type":"stream","text":"Population of species X: [  1000.   2000.   4000.   8000.  16000.  32000.  64000. 128000. 256000.]\n"}},"pos":1,"type":"cell"}
{"cell_type":"code","exec_count":10,"id":"d1aafb","input":"# Load 24h experimental data\ndata_Y = np.loadtxt(\"data_exp_Y.txt\")\n\n# Set up logistic model for species Y\nr_Y = 0.45\nK_Y = 5e4\nn_hours = 24\ninitial_population = 1000\npop_Y = np.zeros(n_hours + 1)\n\npop_Y[0] = initial_population\nfor i in range(n_hours):\n    pop_Y[i + 1] = pop_Y[i] + pop_Y[i] * r_Y * (1 - pop_Y[i]/K_Y)\n    \nplt.figure(figsize=(6,3))\nplt.plot(pop_Y, label=\"model\")\nplt.plot(data_Y, label=\"experiment\")\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species Y\")\nplt.legend()","output":{"0":{"data":{"text/plain":"<matplotlib.legend.Legend at 0x163403100>"},"exec_count":10,"output_type":"execute_result"},"1":{"data":{"image/png":"a1a53e7137d145b0fb4050cbff66e941ce98dfae","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":10,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":16,"type":"cell"}
{"cell_type":"code","exec_count":11,"id":"b8559d","input":"data_A = np.loadtxt(\"data_exp_A.txt\")\ndata_B = np.loadtxt(\"data_exp_B.txt\")\ndata_C = np.loadtxt(\"data_exp_C.txt\")","pos":18,"type":"cell"}
{"cell_type":"code","exec_count":12,"id":"b07620","input":"# Write a function for logistic growth\ndef logistic_growth(r, K, x_0, t_max):\n    pop = np.zeros(t_max + 1)\n    pop[0] = x_0\n    for i in range(t_max):\n        pop[i + 1] = pop[i] + pop[i] * r * (1 - pop[i]/K)\n    return pop\n\n# Growth parameters for each species (adjust values to achieve good fit!)\nr = [.9, .4, .7]\nK = [5.5e5, 5.5e4, 1e5]\nx_0 = [1000, 10000, 1000]\nnames = ['A', 'B', 'C']\n\nfor i, species in enumerate((data_A, data_B, data_C)):\n    \n    # Model population growth with species' parameters\n    pop = logistic_growth(r[i], K[i], x_0[i], 24)\n    \n    # Plot model and data\n    plt.figure(figsize=(6,3))\n    plt.plot(pop, label=\"model\")\n    plt.plot(species, label=\"experiment\")\n\n    plt.xlabel(\"time (hours)\")\n    plt.ylabel(\"population\")\n    plt.title(\"Species {0}\".format(names[i]))\n    plt.legend()","output":{"0":{"data":{"image/png":"375bb4231771872084fc39ade7238d397de8fb35","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":12,"metadata":{"needs_background":"light"},"output_type":"execute_result"},"1":{"data":{"image/png":"3bd6e98bf05123399460cf36d6c5e33eadc901b6","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":12,"metadata":{"needs_background":"light"},"output_type":"execute_result"},"2":{"data":{"image/png":"ee0a4ebd635b449ebd0edc791aa719a9dc79b743","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":12,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":19,"type":"cell"}
{"cell_type":"code","exec_count":2,"id":"99e683","input":"plt.figure(figsize=(6,3))\nplt.plot(pop_X)\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species X\")","output":{"0":{"data":{"text/plain":"Text(0.5, 1.0, 'Species X')"},"exec_count":2,"output_type":"execute_result"},"1":{"data":{"image/png":"b8771b9257a37bd4494cab8146acb672fa37699d","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":2,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":2,"type":"cell"}
{"cell_type":"code","exec_count":21,"id":"8327a6","input":"# Define epidemic model function\ndef epidemic(a, b, t_max, S_0, I_0):\n    \n    S = np.zeros(t_max + 1)\n    I = np.zeros(t_max + 1)\n    \n    S[0] = S_0\n    I[0] = I_0\n    \n    for i in range(t_max):\n        S[i+1] = S[i] - b * S[i] * I[i]\n        I[i+1] = I[i] + b * S[i] * I[i] - a * I[i]\n\n    return S, I","pos":22,"type":"cell"}
{"cell_type":"code","exec_count":3,"id":"442033","input":"# Population with slower growth rate\nr_Y = 0.1\nn_hours = 8\ninitial_population = 1000\npop_Y = np.zeros(n_hours + 1)\n\npop_Y[0] = initial_population\nfor i in range(n_hours):\n    pop_Y[i + 1] = pop_Y[i] + pop_Y[i] * r_Y\n    \nprint(\"Population of species Y:\", pop_Y)\n\nplt.figure(figsize=(6,3))\nplt.plot(pop_Y)\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species Y\")","output":{"0":{"name":"stdout","output_type":"stream","text":"Population of species Y: [1000.      1100.      1210.      1331.      1464.1     1610.51\n 1771.561   1948.7171  2143.58881]\n"},"1":{"data":{"text/plain":"Text(0.5, 1.0, 'Species Y')"},"exec_count":3,"output_type":"execute_result"},"2":{"data":{"image/png":"4b7ab436e682efccd3c4cb561e92a0be5dc96e20","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":3,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":4,"type":"cell"}
{"cell_type":"code","exec_count":4,"id":"493a5f","input":"# Experimental data collected for X\ndata_X = np.array([  1.  ,   2.18,   4.45,   8.91,  16.1 ,  31.49,  60.89, 117.58, 214.4 ]) * 1000\n\n# Plot both data and model prediction\nplt.figure(figsize=(6,3))\nplt.plot(pop_X, label=\"model\")\nplt.plot(data_X, label=\"experiment\")\n\n# Figure labels etc\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species X\")\nplt.legend()","output":{"0":{"data":{"text/plain":"<matplotlib.legend.Legend at 0x163125eb0>"},"exec_count":4,"output_type":"execute_result"},"1":{"data":{"image/png":"f64e4c4128c0ea2487c7ccbaf83447f63dd46d73","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":4,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":6,"type":"cell"}
{"cell_type":"code","exec_count":42,"id":"5da051","input":"# Create model, vary values of a and b\na = 0.07\nb = 0.00002\nS_0 = 20000\nI_0 = 100\n\nt_max = 100\n\nS, I = epidemic(a, b, t_max, S_0, I_0)\n    \nplt.figure(figsize=(6,3))\nplt.plot(S, label=\"Susceptible population\")\nplt.plot(I, label=\"Infected population\")\n# Display legend\nplt.legend()","output":{"0":{"data":{"text/plain":"<matplotlib.legend.Legend at 0x164089790>"},"exec_count":42,"output_type":"execute_result"},"1":{"data":{"image/png":"917a8a452cb85ff78ce3c32c6d963f39e7cb5271","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":42,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":23,"type":"cell"}
{"cell_type":"code","exec_count":5,"id":"294851","input":"# Predictive model for Y\nr_Y = 0.4\nn_hours = 8\ninitial_population = 1000\npop_Y = np.zeros(n_hours + 1)\npop_Y[0] = initial_population\nfor i in range(n_hours):\n    pop_Y[i + 1] = pop_Y[i] + pop_Y[i] * r_Y\n\n# Experimental data collected for Y\ndata_Y = np.array([  1., 1.47, 2.02, 2.81, 4.16, 5.88, 7.98, 10.00, 15.59 ]) * 1000\n\n# Plot both data and model prediction\nplt.figure(figsize=(6,3))\nplt.plot(pop_Y, label=\"model\")\nplt.plot(data_Y, label=\"experiment\")\n\n# Figure labels etc.\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species Y\")\nplt.legend()","output":{"0":{"data":{"text/plain":"<matplotlib.legend.Legend at 0x16320d580>"},"exec_count":5,"output_type":"execute_result"},"1":{"data":{"image/png":"01a4d1713fd01ca28be49f14cd8d810bb99c5595","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":5,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":8,"type":"cell"}
{"cell_type":"code","exec_count":6,"id":"2ce676","input":"data_X = np.loadtxt(\"data_exp_X.txt\")\nprint(data_X)","output":{"0":{"name":"stdout","output_type":"stream","text":"[1.00000000e+03 2.17777342e+03 4.44576258e+03 8.91456547e+03\n 1.60958432e+04 3.14897238e+04 6.08883077e+04 1.17580768e+05\n 2.14397399e+05 3.81989811e+05 6.03315856e+05 7.87285829e+05\n 9.96982461e+05 1.04405640e+06 1.08337178e+06 9.95533440e+05\n 9.79746583e+05 9.72332987e+05 9.21969859e+05 1.04273060e+06\n 9.43221236e+05 9.37714865e+05 9.85877957e+05 1.07409317e+06]\n"}},"pos":10,"type":"cell"}
{"cell_type":"code","exec_count":7,"id":"a831af","input":"r_X = 1\nn_hours = 24\ninitial_population = 1000\npop_X = np.zeros(n_hours + 1)\n\npop_X[0] = initial_population\nfor i in range(n_hours):\n    pop_X[i + 1] = pop_X[i] + pop_X[i] * r_X\n    \nplt.figure(figsize=(6,3))\nplt.plot(pop_X, label=\"model\")\nplt.plot(data_X, label=\"experiment\")\n\n# Uncomment the line below to get a more informative figure\nplt.ylim(0, 1.2e6)\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species X\")\nplt.legend()","output":{"0":{"data":{"text/plain":"<matplotlib.legend.Legend at 0x1632c5ee0>"},"exec_count":7,"output_type":"execute_result"},"1":{"data":{"image/png":"581286af3e30bb2532935cfa7656fb8421b1137d","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":7,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":11,"type":"cell"}
{"cell_type":"code","exec_count":8,"id":"b2de41","input":"plt.figure(figsize=(6,3))\nplt.plot(data_X)","output":{"0":{"data":{"text/plain":"[<matplotlib.lines.Line2D at 0x163356790>]"},"exec_count":8,"output_type":"execute_result"},"1":{"data":{"image/png":"8c2623b13b530fc7e57b58dd46be6e0d06cd1231","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":8,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":12,"type":"cell"}
{"cell_type":"code","exec_count":9,"id":"97e132","input":"# Set up model for species X\nr_X = 1\nK_X = 1e6\nn_hours = 24\ninitial_population = 1000\n\npop_X = np.zeros(n_hours + 1)\npop_X[0] = initial_population\n\n# Simulate logistic growth\nfor i in range(n_hours):\n    pop_X[i + 1] = pop_X[i] + pop_X[i] * r_X * (1 - pop_X[i]/K_X)\n\n# Plot of model and experimental data\nplt.figure(figsize=(6,3))\nplt.plot(pop_X, label=\"model\")\nplt.plot(data_X, label=\"experiment\")\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species X\")\nplt.legend()","output":{"0":{"data":{"text/plain":"<matplotlib.legend.Legend at 0x163378e50>"},"exec_count":9,"output_type":"execute_result"},"1":{"data":{"image/png":"1e4894bef22ea79725370873ceee46f20177553a","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":9,"metadata":{"needs_background":"light"},"output_type":"execute_result"}},"pos":14,"type":"cell"}
{"cell_type":"markdown","id":"3967c4","input":"### Species Y","pos":15,"type":"cell"}
{"cell_type":"markdown","id":"50d6ae","input":"## Epidemic model","pos":21,"type":"cell"}
{"cell_type":"markdown","id":"692844","input":"# Workshop 4 Answers\n\n## Species X simulation","pos":0,"type":"cell"}
{"cell_type":"markdown","id":"77270d","input":"## Species Y experimental data","pos":7,"type":"cell"}
{"cell_type":"markdown","id":"776cf0","input":"## Logistic Growth\n\n### Species X","pos":13,"type":"cell"}
{"cell_type":"markdown","id":"c864c9","input":"## Species Y simulation","pos":3,"type":"cell"}
{"cell_type":"markdown","id":"cb021e","input":"### Solution\n\n|Species|Dataset|r|K|$x_0$|\n|---|---|---|---|---|\n|1|B|0.4|5.5e4|10000|\n|2|C|0.7|1e5|1000|\n|3|A|0.9|5.5e5|1000|","pos":20,"type":"cell"}
{"cell_type":"markdown","id":"ce5fd9","input":"## Exercise\n\nLoad experimental data for species A, B, C","pos":17,"type":"cell"}
{"cell_type":"markdown","id":"d44eac","input":"## Species X experimental data","pos":5,"type":"cell"}
{"cell_type":"markdown","id":"e086f5","input":"## 24h experiment\n\nLoading experimental data:","pos":9,"type":"cell"}
{"id":0,"time":1635854487315,"type":"user"}
{"last_load":1636387088306,"type":"file"}