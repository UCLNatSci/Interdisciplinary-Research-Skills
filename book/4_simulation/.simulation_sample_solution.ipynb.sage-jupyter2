{"backend_state":"init","kernel":"python3","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.7"}},"trust":false,"type":"settings"}
{"cell_type":"code","exec_count":11,"id":"294851","input":"# Predictive model for Y\nr_Y = 0.4\nn_hours = 8\ninitial_population = 1000\npop_Y = np.zeros(n_hours + 1)\npop_Y[0] = initial_population\nfor i in range(n_hours):\n    pop_Y[i + 1] = pop_Y[i] + pop_Y[i] * r_Y\n\n# Experimental data collected for Y\ndata_Y = np.array([  1., 1.47, 2.02, 2.81, 4.16, 5.88, 7.98, 10.00, 15.59 ]) * 1000\n\n# Plot both data and model prediction\nplt.figure(figsize=(6,3))\nplt.plot(pop_Y, label=\"model\")\nplt.plot(data_Y, label=\"experiment\")\n\n# Figure labels etc.\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species Y\")\nplt.legend()","output":{"0":{"data":{"text/plain":"<matplotlib.legend.Legend at 0x7f92aa6ea3a0>"},"exec_count":11,"output_type":"execute_result"},"1":{"data":{"image/png":"61c54d336e48dcd777b3d269fd58761cd309585e","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":11,"metadata":{"image/png":{"height":222,"width":401},"needs_background":"light"},"output_type":"execute_result"}},"pos":8,"type":"cell"}
{"cell_type":"code","exec_count":14,"id":"2ce676","input":"data_X = np.loadtxt(\"data_exp_X.txt\")\nprint(data_X)","output":{"0":{"name":"stdout","output_type":"stream","text":"[1.00000000e+03 2.17777342e+03 4.44576258e+03 8.91456547e+03\n 1.60958432e+04 3.14897238e+04 6.08883077e+04 1.17580768e+05\n 2.14397399e+05 3.81989811e+05 6.03315856e+05 7.87285829e+05\n 9.96982461e+05 1.04405640e+06 1.08337178e+06 9.95533440e+05\n 9.79746583e+05 9.72332987e+05 9.21969859e+05 1.04273060e+06\n 9.43221236e+05 9.37714865e+05 9.85877957e+05 1.07409317e+06]\n"}},"pos":10,"type":"cell"}
{"cell_type":"code","exec_count":15,"id":"b2de41","input":"plt.figure(figsize=(6,3))\nplt.plot(data_X)","output":{"0":{"data":{"text/plain":"[<matplotlib.lines.Line2D at 0x7f7f216b2b20>]"},"exec_count":15,"output_type":"execute_result"},"1":{"data":{"image/png":"f27793ad664b298dc20742a027ded49db810386f","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":15,"metadata":{"image/png":{"height":204,"width":372},"needs_background":"light"},"output_type":"execute_result"}},"pos":12,"type":"cell"}
{"cell_type":"code","exec_count":17,"id":"a831af","input":"r_X = 1\nn_hours = 24\ninitial_population = 1000\npop_X = np.zeros(n_hours + 1)\n\npop_X[0] = initial_population\nfor i in range(n_hours):\n    pop_X[i + 1] = pop_X[i] + pop_X[i] * r_X\n    \nplt.figure(figsize=(6,3))\nplt.plot(pop_X, label=\"model\")\nplt.plot(data_X, label=\"experiment\")\n\n# Uncomment the line below to get a more informative figure\nplt.ylim(0, 1.2e6)\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species X\")\nplt.legend()","output":{"0":{"data":{"text/plain":"<matplotlib.legend.Legend at 0x7f92aa44ba60>"},"exec_count":17,"output_type":"execute_result"},"1":{"data":{"image/png":"ad3da68e94e9cf053b971c90c5fecd6453d50241","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":17,"metadata":{"image/png":{"height":222,"width":389},"needs_background":"light"},"output_type":"execute_result"}},"pos":11,"type":"cell"}
{"cell_type":"code","exec_count":2,"id":"99e683","input":"plt.figure(figsize=(6,3))\nplt.plot(pop_X)\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species X\")","output":{"0":{"data":{"text/plain":"Text(0.5, 1.0, 'Species X')"},"exec_count":2,"output_type":"execute_result"},"1":{"data":{"image/png":"e6a2a35975637fa62aee16af0b064832ab1c22da","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":2,"metadata":{"image/png":{"height":222,"width":408},"needs_background":"light"},"output_type":"execute_result"}},"pos":2,"type":"cell"}
{"cell_type":"code","exec_count":20,"id":"97e132","input":"# Set up model for species X\nr_X = 1\nK_X = 1e6\nn_hours = 24\ninitial_population = 1000\n\npop_X = np.zeros(n_hours + 1)\npop_X[0] = initial_population\n\n# Simulate logistic growth\nfor i in range(n_hours):\n    pop_X[i + 1] = pop_X[i] + pop_X[i] * r_X * (1 - pop_X[i]/K_X)\n\n# Plot of model and experimental data\nplt.figure(figsize=(6,3))\nplt.plot(pop_X, label=\"model\")\nplt.plot(data_X, label=\"experiment\")\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species X\")\nplt.legend()","output":{"0":{"data":{"text/plain":"<matplotlib.legend.Legend at 0x7f92aa373400>"},"exec_count":20,"output_type":"execute_result"},"1":{"data":{"image/png":"606b39e3c23e17afe224023c876702c5ed58148e","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":20,"metadata":{"image/png":{"height":222,"width":389},"needs_background":"light"},"output_type":"execute_result"}},"pos":14,"type":"cell"}
{"cell_type":"code","exec_count":22,"id":"d1aafb","input":"# Load 24h experimental data\ndata_Y = np.loadtxt(\"data_exp_Y.txt\")\n\n# Set up logistic model for species Y\nr_Y = 0.45\nK_Y = 5e4\nn_hours = 24\ninitial_population = 1000\npop_Y = np.zeros(n_hours + 1)\n\npop_Y[0] = initial_population\nfor i in range(n_hours):\n    pop_Y[i + 1] = pop_Y[i] + pop_Y[i] * r_Y * (1 - pop_Y[i]/K_Y)\n    \nplt.figure(figsize=(6,3))\nplt.plot(pop_Y, label=\"model\")\nplt.plot(data_Y, label=\"experiment\")\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species Y\")\nplt.legend()","output":{"0":{"data":{"text/plain":"<matplotlib.legend.Legend at 0x7f92aa25b2e0>"},"exec_count":22,"output_type":"execute_result"},"1":{"data":{"image/png":"fdce56bf9c3b92f43fbd225f552e3ac7cd4df4d2","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":22,"metadata":{"image/png":{"height":222,"width":405},"needs_background":"light"},"output_type":"execute_result"}},"pos":16,"type":"cell"}
{"cell_type":"code","exec_count":24,"id":"b8559d","input":"data_A = np.loadtxt(\"data_exp_A.txt\")\ndata_B = np.loadtxt(\"data_exp_B.txt\")\ndata_C = np.loadtxt(\"data_exp_C.txt\")","pos":18,"type":"cell"}
{"cell_type":"code","exec_count":25,"id":"b07620","input":"# Write a function for logistic growth\ndef logistic_growth(r, K, x_0, t_max):\n    pop = np.zeros(t_max + 1)\n    pop[0] = x_0\n    for i in range(t_max):\n        pop[i + 1] = pop[i] + pop[i] * r * (1 - pop[i]/K)\n    return pop\n\n# Growth parameters for each species (adjust values to achieve good fit!)\nr = [.9, .4, .7]\nK = [5.5e5, 5.5e4, 1e5]\nx_0 = [1000, 10000, 1000]\nnames = ['A', 'B', 'C']\n\nfor i, species in enumerate((data_A, data_B, data_C)):\n    \n    # Model population growth with species' parameters\n    pop = logistic_growth(r[i], K[i], x_0[i], 24)\n    \n    # Plot model and data\n    plt.figure(figsize=(6,3))\n    plt.plot(pop, label=\"model\")\n    plt.plot(species, label=\"experiment\")\n\n    plt.xlabel(\"time (hours)\")\n    plt.ylabel(\"population\")\n    plt.title(\"Species {0}\".format(names[i]))\n    plt.legend()","output":{"0":{"data":{"image/png":"bc456b8ca228ad98fff1e16925f41e82926bb850","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":25,"metadata":{"image/png":{"height":222,"width":412},"needs_background":"light"},"output_type":"execute_result"},"1":{"data":{"image/png":"944599e38d46338ce4677a75431cfa98e25e8d87","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":25,"metadata":{"image/png":{"height":222,"width":405},"needs_background":"light"},"output_type":"execute_result"},"2":{"data":{"image/png":"690b0aa323eb6712dbb9ea7b6b748d1615db1e5e","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":25,"metadata":{"image/png":{"height":222,"width":412},"needs_background":"light"},"output_type":"execute_result"}},"pos":19,"type":"cell"}
{"cell_type":"code","exec_count":5,"id":"2e2a1b","input":"import numpy as np\nimport matplotlib.pyplot as plt\n\nr_X = 1\nn_hours = 8\ninitial_population = 1000\npop_X = np.zeros(n_hours + 1)\n\npop_X[0] = initial_population\nfor i in range(n_hours):\n    pop_X[i + 1] = pop_X[i] + pop_X[i] * r_X\n    \nprint(\"Population of species X:\", pop_X)","output":{"0":{"name":"stdout","output_type":"stream","text":"Population of species X: [  1000.   2000.   4000.   8000.  16000.  32000.  64000. 128000. 256000.]\n"}},"pos":1,"type":"cell"}
{"cell_type":"code","exec_count":7,"id":"493a5f","input":"# Experimental data collected for X\ndata_X = np.array([  1.  ,   2.18,   4.45,   8.91,  16.1 ,  31.49,  60.89, 117.58, 214.4 ]) * 1000\n\n# Plot both data and model prediction\nplt.figure(figsize=(6,3))\nplt.plot(pop_X, label=\"model\")\nplt.plot(data_X, label=\"experiment\")\n\n# Figure labels etc\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species X\")\nplt.legend()","output":{"0":{"data":{"text/plain":"<matplotlib.legend.Legend at 0x7f92aa8e7e50>"},"exec_count":7,"output_type":"execute_result"},"1":{"data":{"image/png":"d7b791b7d9c8d7fedd4128224550610669afc948","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":7,"metadata":{"image/png":{"height":222,"width":408},"needs_background":"light"},"output_type":"execute_result"}},"pos":6,"type":"cell"}
{"cell_type":"code","exec_count":8,"id":"442033","input":"# Population with slower growth rate\nr_Y = 0.1\nn_hours = 8\ninitial_population = 1000\npop_Y = np.zeros(n_hours + 1)\n\npop_Y[0] = initial_population\nfor i in range(n_hours):\n    pop_Y[i + 1] = pop_Y[i] + pop_Y[i] * r_Y\n    \nprint(\"Population of species Y:\", pop_Y)\n\nplt.figure(figsize=(6,3))\nplt.plot(pop_Y)\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species Y\")","output":{"0":{"name":"stdout","output_type":"stream","text":"Population of species Y: [1000.      1100.      1210.      1331.      1464.1     1610.51\n 1771.561   1948.7171  2143.58881]\n"},"1":{"data":{"text/plain":"Text(0.5, 1.0, 'Species Y')"},"exec_count":8,"output_type":"execute_result"},"2":{"data":{"image/png":"e1fc8e69d4cb3c780c8ba7c047eabf7446d85978","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":8,"metadata":{"image/png":{"height":222,"width":395},"needs_background":"light"},"output_type":"execute_result"}},"pos":4,"type":"cell"}
{"cell_type":"markdown","id":"3967c4","input":"### Species Y","pos":15,"type":"cell"}
{"cell_type":"markdown","id":"692844","input":"## Species X simulation","pos":0,"type":"cell"}
{"cell_type":"markdown","id":"77270d","input":"## Species Y experimental data","pos":7,"type":"cell"}
{"cell_type":"markdown","id":"776cf0","input":"## Logistic Growth\n\n### Species X","pos":13,"type":"cell"}
{"cell_type":"markdown","id":"c864c9","input":"## Species Y simulation","pos":3,"type":"cell"}
{"cell_type":"markdown","id":"cb021e","input":"### Solution\n\n|Species|Dataset|r|K|$x_0$|\n|---|---|---|---|---|\n|1|B|0.4|5.5e4|10000|\n|2|C|0.7|1e5|1000|\n|3|A|0.9|5.5e5|1000|","pos":20,"type":"cell"}
{"cell_type":"markdown","id":"ce5fd9","input":"## Exercise\n\nLoad experimental data for species A, B, C","pos":17,"type":"cell"}
{"cell_type":"markdown","id":"d44eac","input":"## Species X experimental data","pos":5,"type":"cell"}
{"cell_type":"markdown","id":"e086f5","input":"## 24h experiment\n\nLoading experimental data:","pos":9,"type":"cell"}
{"id":0,"time":1635854487315,"type":"user"}
{"last_load":1635794547512,"type":"file"}