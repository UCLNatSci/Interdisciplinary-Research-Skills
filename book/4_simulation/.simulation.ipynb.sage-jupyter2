{"backend_state":"init","connection_file":"/tmp/xdg-runtime-user/jupyter/kernel-ece13960-bd6b-48a3-97bb-d0d6755a2a4d.json","kernel":"python3","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.10"}},"trust":true,"type":"settings"}
{"cell_type":"code","exec_count":3,"id":"54f1a1","input":"plt.figure(figsize=(6,3))\nplt.plot(pop)\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species X\")","output":{"0":{"data":{"text/plain":"Text(0.5, 1.0, 'Species X')"},"exec_count":3,"output_type":"execute_result"},"1":{"data":{"image/png":"f0e3b3be001ee07aa955d204c8dac8c55f55daf6","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":3,"metadata":{"image/png":{"height":222,"width":395},"needs_background":"light"},"output_type":"execute_result"}},"pos":3,"type":"cell"}
{"cell_type":"code","exec_count":4,"id":"530433","input":"data_x = np.array([1, 2, 3, 4, 5, 5, 6])\n\nplt.figure(figsize=(6,3))\nplt.plot(pop)\nplt.plot(data_x)\n\nplt.xlabel(\"time (hours)\")\nplt.ylabel(\"population\")\nplt.title(\"Species X\")","output":{"0":{"data":{"text/plain":"Text(0.5, 1.0, 'Species X')"},"exec_count":4,"output_type":"execute_result"},"1":{"data":{"image/png":"c3e9a711fb87e02b729228394637cabc90ce3fa3","text/plain":"<Figure size 432x216 with 1 Axes>"},"exec_count":4,"metadata":{"image/png":{"height":222,"width":395},"needs_background":"light"},"output_type":"execute_result"}},"pos":6,"type":"cell"}
{"cell_type":"code","exec_count":6,"id":"a11cf8","input":"import numpy as np\nimport matplotlib.pyplot as plt\n\nn_hours = 12\ninitial_population = 1\npop = np.zeros(n_hours)\n\npop[0] = initial_population\nfor i in range(n_hours - 1):\n    pop[i + 1] = pop[i] + pop[i] * 2\n    \nprint(\"Population of species X:\", pop)","output":{"0":{"name":"stdout","output_type":"stream","text":"Population of species X: [1.00000e+00 3.00000e+00 9.00000e+00 2.70000e+01 8.10000e+01 2.43000e+02\n 7.29000e+02 2.18700e+03 6.56100e+03 1.96830e+04 5.90490e+04 1.77147e+05]\n"}},"pos":1,"type":"cell"}
{"cell_type":"code","exec_count":8,"id":"8fb725","input":"data_x = np.loadtxt(\"data_exp_X.txt\")\nprint(data_x)\n","output":{"0":{"name":"stdout","output_type":"stream","text":"[1.44500000e+03 3.04598033e+03 7.05395090e+03 1.46223406e+04\n 2.83395981e+04 5.99160544e+04 1.21477049e+05 2.33623379e+05\n 4.97454637e+05 9.41374220e+05 1.92484952e+06 3.64943967e+06\n 6.57174287e+06 9.16709186e+06 1.06635618e+07 9.49095615e+06\n 9.55100436e+06 1.04547338e+07 9.89253974e+06 9.90477520e+06\n 1.02613250e+07 9.30972719e+06 1.01668613e+07 1.02740221e+07]\n"},"1":{"data":{"text/plain":"[<matplotlib.lines.Line2D at 0x7fcb8909a250>]"},"exec_count":8,"output_type":"execute_result"},"2":{"data":{"image/png":"1d15f6c68de6de50e95e6969bd1221376ace6872","text/plain":"<Figure size 864x504 with 1 Axes>"},"exec_count":8,"metadata":{"image/png":{"height":421,"width":707},"needs_background":"light"},"output_type":"execute_result"}},"pos":8,"type":"cell"}
{"cell_type":"markdown","id":"127f47","input":"> Plot graphs for species for the two species, each containg the experimental and simulated populations for 24 hours.\n> What do you notice? Does the model accurately predict the experiments?\n\nYou should have noticed that eventually the two populations stop increasing, likely due to exhausting resources such as nutrients or physical space. Our simple exponential model above is insufficient to take this into account.\n\nInstead, we can consider a more sophisticated model, *logistic growth*.\n\n$$x_{i+1} = x_i + r(1-x_i/K)x_i $$\n\nthe growth rate $r$ has been replaced by the term $r(1-x_i/K)$. For small populations (when $x_i$ is much less than $K$) the growth rate is close to $r$. As the population size approaches the value $K$, the growth rate reduces to zero.\n\n> Adapt the simulation to use the new equation. You will need to create a new variable `K` and change the line `pop[i + 1] = pop[i] + pop[i] * 2`.\n> Run the simulation for each species. You will need to choose an appropriate value of `K` for each.","pos":9,"type":"cell"}
{"cell_type":"markdown","id":"19e5e4","input":"> Plot the predicted population of species Y","pos":4,"type":"cell"}
{"cell_type":"markdown","id":"349afe","input":"NB Python uses *exponential notation* to express decimal numbers e.g. $2048 = 2.048 \\times 10^3$ is expressed as `2.048e+03`.\n\n> Use the code above to simulate the growth of a population Y\n\nUsing `plt.plot` we can visualise the population curve over the 12 hours:","pos":2,"type":"cell"}
{"cell_type":"markdown","id":"84c57b","input":"# Workshop 3: Modelling and Simulation\n\n## Introduction\n\nWhat is model, what is a simulation? How does it fit into the scientific method?\n\n## Exponential Growth [from Khan Academy]\nBacteria grown in the lab provide an excellent example of exponential growth. In exponential growth, the population’s growth rate increases over time, in proportion to the size of the population.\nLet’s take a look at how this works. Bacteria reproduce by binary fission (splitting in half), and the time between divisions is about an hour for many bacterial species. To see how this exponential growth, let's start by placing 100010001000 bacteria in a flask with an unlimited supply of nutrients.\nAfter 111 hour: Each bacterium will divide, yielding 200020002000 bacteria (an increase of 100010001000 bacteria).\nAfter 222 hours: Each of the 200020002000 bacteria will divide, producing 400040004000 (an increase of 200020002000 bacteria).\nAfter 333 hours: Each of the 400040004000 bacteria will divide, producing 800080008000 (an increase of 400040004000 bacteria).\nThe key concept of exponential growth is that the population growth rate —the number of organisms added in each generation—increases as the population gets larger. And the results can be dramatic: after 111 day (242424 cycles of division), our bacterial population would have grown from 100010001000 to over 161616 billion!\n\n\n|Species|r|0|1|2|3|4|5|6|\n|---|---|---|---|---|---|---|---|---|\n|X|1.1|1|2|3|4|5|5|6|\n|Y|.1|2|2|3|4|4|4|4|\n\n## Modelling exponential growth\n\nSuppose a population of bacteria doubles in size every hour. Then we can model the population using the following equation:\n\n$$x_{i+1} = x_i + rx_i $$\n\nwhere $x_i$ is the population at hour $i$. The equation simply represents the fact that the population at hour $i+1$ is $r+1$ times the population at hour $i$.\n\nSuppose that the initial population is exactly $1$ and we would like to simulate the population size for 12 hours.","pos":0,"type":"cell"}
{"cell_type":"markdown","id":"937973","input":"Below are the results of a laboratory experiment conducted in order to measure the growth in the two species of bacteria. The population of each was recorded every hour (if you are interested in how this might be performed in practice, see [here](https://courses.lumenlearning.com/boundless-microbiology/chapter/counting-bacteria/)).\n\n|Species|0|1|2|3|4|5|6|\n|---|---|---|---|---|---|---|---|\n|X|1|2|3|4|5|5|6|\n|Y|2|2|3|4|4|4|4|\n\nLet's plot this experimental data on the same graph as the model simulation.\n\n","pos":5,"type":"cell"}
{"cell_type":"markdown","id":"b28488","input":"## Exercise\n\nIn the folder `data` are text files containing results of 4 bacterial population growth experiments. For each one, plot the data and by running a simulation for each, estimate the value of $r$ and $K$. Which data file corresponds to which experiment?\n\n**TODO: generate the data and check**","pos":10,"type":"cell"}
{"cell_type":"markdown","id":"f43b2b","input":"> Plot the experimental population data for species Y on the same graph as the module simulation for species Y.\n\nThe experimenter continues the experiment for a full 24 hours. The results of the two experiment are in the two files `data_exp_X.txt` and `data_exp_Y.txt`. We can use the `numpy` function `np.loadtxt` to load the data into a numpy array:","pos":7,"type":"cell"}
{"id":0,"time":1630681943794,"type":"user"}
{"last_load":1630771234507,"type":"file"}